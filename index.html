<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="var(--bodybg)">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="index.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/material-design-iconic-font/2.2.0/css/material-design-iconic-font.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/github-dark.min.css">
  <title>Namaste NodeJs</title>
</head>
<body>
<main>
<!-- Navbar -->
<nav>
 <h1>Namaste <span>NodeJs</span></h1>
 <div>
 <i class="zmdi zmdi-brightness-7"></i>
 <i class="zmdi zmdi-github"></i>
 </div>
</nav>

<!-- Content & Season -->
<div class="table">
 <div class="content">
 <p>Table of Content <i class="zmdi zmdi-caret-down"></i></p>
 <div>
<!-- <span class="active">1st design</span> -->  
 </div>
 </div> 
 <div class="season">
 <p>Season - 01<i class="zmdi zmdi-caret-down"></i></p>
 <div><span>Season - 01</span><span>Season - 02</span><span>Season - 03</span></div>
 </div>
</div>
<!-- Quick Keys -->
<div class="keys">
 <button onclick="download()">Download <i class="zmdi zmdi-download"></i><div></div></button>
 <button onclick="share()">Share <i class="zmdi zmdi-share"></i></button>
 <button onclick="report()">Report <i class="zmdi zmdi-alert-circle-o"></i><div></div></button>
</div>


<!-- Notes -->
<div class="notes">
 <div class="markdown-body"></div>
 
 <div class="codes">
  <p>Code Files<i class="zmdi zmdi-download"></i></p>
  <div></div>
 </div>
 
 <div class="code-file">
  <div>
  <span><i class="zmdi zmdi-file-text"></i>File.txt</span>
  <span>
   <i class="zmdi zmdi-download"></i>
   <i class="zmdi zmdi-copy"></i>
  </span>
  </div>
  <pre></pre>
 </div>
 
 <div class="notes-keys">
  <button onclick="prev()">< Prev</button>
  <button onclick="next()">Next ></button>
 </div>
</div>

<!-- footer -->
<div class="footer">
 <h1>Namaste <span>NodeJs</span><div></div></h1>
 <p>Notes by <a href="https://github.com/akshadjaiswal">Akshad Jaiswal</a></p>
 <p>Website by <a href="https://github.com/abtp2">Ashutosh_dev</a></p>
 <p>Orginal content by <a href="https://github.com/akshaymarch7">Akshay Saini</a></p>
</div>



</main>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>
<script>
//custom script 
function $(selector,parent){
var x;
try{
const elements = document.querySelectorAll(selector);
if(elements.length == 1){x = elements[0]}
else{x = elements}
}catch(error){
x = error;
}return x;
}

/* Dark Mode */
let mode = localStorage.getItem("mode");
window.addEventListener("load", ()=>{
 if(mode && mode =="dark"){
 $("html").classList.add("dark");
 }else{
 $("html").classList.remove("dark");
 }
});
$("nav div i")[0].onclick =()=>{
$("html").classList.toggle("dark");
$("nav div i")[0].classList.add("spin");
if($("html").classList[0] =="dark"){
 localStorage.setItem("mode", "dark");
}else{
 localStorage.setItem("mode", "light");
}
setTimeout(()=>{
 $("nav div i")[0].classList.remove("spin");
},300);
}

/* GitHub */
$("nav div i")[1].onclick =()=>{window.open("https://github.com/abtp2/Namaste-NodeJs", "_blank");
}

/* Table of content */
$(".table p").forEach((p)=>{
p.onclick =()=>{
p.parentElement.querySelector("div").classList.toggle("open-table");
}
});

/* Data */
let data ={
S01 : [
"S1 01 - Introduction to NodeJs",
"S1 02 - JS on the Server",
"S1 03 - Let's Write the code",
"S1 04 - module.export & require",
"S1 05 - Diving in to NodeJS github repo",
"S1 06 - libuv & async IO",
"S1 07 - sync async, setTimeout Zero - Code",
"S1 08 -  Deep dive into v8 JS Engine",
"S1 09 - libuv & event loop",
"S1 10 - Thread Pool in libuv",
"S1 11 - Creating the Server",
"S1 12 - Databases SQL and NoSQL",
"S1 13 - Creating a database & mongodb"
],
S02 : [
"S2 01 - Microservices vs Monolith - How to build a project",
"S2 02 - Features, HLD  LLD and Planning",
"S2 03 - Creating our Express server",
"S2 04 - Routing and Request handlers",
"S2 05 - Middlewares and Error Handlers",
"S2 06 - Database, Schema, Models & Mongoose",
"S2 07 - Diving into APIs",
"S2 08 - Data Sanitization & Schema Validations",
"S2 09 - Encrypting Passwords",
"S2 10 - Authentication, JWT & Cookies",
"S2 11 - Diving into the APIs and Express router",
"S2 12 - Logical DB Query and Compound Indexes",
"S2 13 - ref, Populate and Thought Process of writing API's",
"S2 14 - Building Feed API and Pagination",
"S2 15 - DevTinder UI - Part 1",
"S2 16 - DevTinder UI - Part 2",
"S2 17 - DevTinder UI - Part 3",
"S2 18 - DevTinder UI - Part 4",
"S2 19 - DevTinder UI - Part 5"
],
S03 : [
"S3 01 - Lanching an AWS Instance and Deploying frontend",
"S3 02 - Nginx and Backend Node App Development",
"S3 03 - Adding a custom Domain name"
]
};


let extraData ={
3 : [
"app.js"
],
4 : [
"app.js",
"data.json",
"package.json",
"calculate/index.js",
"calculate/multiply.js",
"calculate/sum.js",
],
5 : [
"modules.js"
],
7 : [
"async.js",
"blocking.js",
"file.txt",
"setTimeoutZero.js",
"sync.js",
],
9 : [
"Eventloop.js",
"Eventloop2.js",
"Eventloop3.js",
"Eventloop4.js",
"file.txt",
],
10 : [
"file.txt",
"ThreadPool.js"
],
11 : [
"Server.js",
],
13 : [
"db.js"
],
};


/* Load Markdown */
let getExtension = filename => filename.slice(filename.lastIndexOf('.') + 1 || Infinity);
function loadAllMarkdown(x,y){
return new Promise((resolve, reject) =>{
fetch(`./main/${data[x][y]}/README.md`)
   .then(response => response.text())
   .then(markdown => {
    const html = marked.parse(markdown);
     $(".markdown-body").innerHTML = html;
     hideCodeFile();
     if(x=="S01" && Object.keys(extraData).includes(String(y+1))){
     $(".codes").style.display ="flex";
     $(".codes div").innerHTML ="";
     extraData[y+1].forEach((name)=>{
     let icon;
     if(getExtension(name) =="js") icon ="language-javascript";
     else if(getExtension(name) =="json") icon ="code";
     else if(getExtension(name) =="txt") icon ="file-text";
      $(".codes div").innerHTML +=`
      <span><i class="zmdi zmdi-${icon}"></i>${name}</span>
      `;
      activateCodes(y).then(()=>{
      if($(".code-file pre code").length != 0) reHighlight($(".code-file pre code"));
      });
     });
     }else{
     $(".codes").style.display ="none";
     }
     resolve();       
    });
});
}
loadAllMarkdown("S01",0).then(() =>{
if($(".markdown-body pre code")[0]){
$(".markdown-body pre code").forEach((elem)=>{
 reHighlight(elem);
});}
$(".content div span")[0].classList.add("active");
});



/* Loading Content */
for(let x of data["S01"]){
$(".content div").innerHTML +=`<span>${x.slice(3)}</span>`;
}
activeLoadContent();
$(".season div span").forEach((span)=>{
span.onclick =(e)=>{
let inner = e.target.innerHTML;
let result = inner[0] + inner.slice(-2);
 $(".season p").innerHTML = `${inner}<i class="zmdi zmdi-caret-down"></i>`;
 $(".content div").innerHTML ="";
 for(let x of data[result]){
 $(".content div").innerHTML +=`<span>${x.slice(3)}</span>`;
 }
 activeLoadContent();
 loadAllMarkdown(result,0).then(() =>{
 if($(".markdown-body pre code")[0]){
 $(".markdown-body pre code").forEach((elem)=>{
 reHighlight(elem);
 });}
   $(".content div span").forEach((span)=>{
   span.classList.remove("active");
   })
   $(".content div span")[0].classList.add("active");
   $(".content div").scroll(0,0);
 });
}});

/* Loading Content */
function activeLoadContent(){
$(".content div span").forEach((span,index)=>{
span.onclick =(e)=>{
let season = $(".season p").innerHTML[0] + $(".season p").innerHTML[9] + $(".season p").innerHTML[10];
let result = season[0] + season[2] + " " + e.target.innerText;

$(".content div span").forEach((span)=>{
 span.classList.remove("active");
});
$(".content div span")[index].classList.add("active");   
 loadAllMarkdown(season,index).then(() =>{
 if($(".markdown-body pre code")[0]){
 $(".markdown-body pre code").forEach((elem)=>{
 reHighlight(elem);
 });}
 });
}});
}



/* Prev & Next */
let getPrevNext = (c, m) => ({ prev: c > 1 ? c - 1 : m, next: c < m ? c + 1 : 1 });


function prev(){
window.scrollTo({ top: 0, behavior: "smooth" });
let season = $(".season p").innerHTML[0] + $(".season p").innerHTML[9] + $(".season p").innerHTML[10];
let contentLen = $(".content div span").length;
let seasonLen = $(".season div span").length;
let activeContent;
  $(".content div span").forEach((span, index)=>{
  if(span.classList.contains("active")){
  activeContent = index;
  }});

if(season =="S02" && activeContent == 0){
 $(".season div span")[0].click();
}
else if(season =="S03" && activeContent == 0){
 $(".season div span")[1].click();
}
else if(season =="S01" && activeContent == 0){
 $(".season div span")[2].click();
}
else{
 $(".content div span")[getPrevNext(activeContent + 1, contentLen).prev - 1].click();
 $(".content div span")[getPrevNext(activeContent + 1, contentLen).prev - 1].scrollIntoView();
 window.scrollTo({ top: 0, behavior: "smooth" });
}}

function next(){
window.scrollTo({ top: 0, behavior: "smooth" });
let season = $(".season p").innerHTML[0] + $(".season p").innerHTML[9] + $(".season p").innerHTML[10];
let contentLen = $(".content div span").length;
let seasonLen = $(".season div span").length;
let activeContent;
  $(".content div span").forEach((span, index)=>{
  if(span.classList.contains("active")){
  activeContent = index;
  }});

if(season =="S01" && activeContent == 12){
 $(".season div span")[1].click();
}
else if(season =="S02" && activeContent == 18){
 $(".season div span")[2].click();
}
else if(season =="S03" && activeContent == 2){
 $(".season div span")[0].click();
}
else{
 $(".content div span")[getPrevNext(activeContent + 1, contentLen).next - 1].click();
 $(".content div span")[getPrevNext(activeContent + 1, contentLen).next - 1].scrollIntoView();
 window.scrollTo({ top: 0, behavior: "smooth" });
}}




/* Codes & Code File */
function activateCodes(y){
return new Promise((resolve, reject) =>{
document.querySelectorAll(".codes div span").forEach((span)=>{
span.onclick =()=>{
const fileName = span.innerText;
 fetch(`./main/${data.S01[y]}/Code/${fileName}`)
   .then(response => response.text())
   .then(code => {
   showCodeFile(span.innerHTML, code, getExtension(fileName));
   if($(".code-file pre code").length != 0) reHighlight($(".code-file pre code"));
   })
}});

$(".codes p i").onclick =()=>{
 const link = document.createElement('a');
 link.href = `./main/${data.S01[y]}/${y+1}-Code.zip`;
 link.download = `Session01-ep${y+1}-codefiles.zip`;
 document.body.appendChild(link);
 link.click();
 document.body.removeChild(link);
}
resolve();
});
}


function showCodeFile(x,y,ext){
let lang;
if(ext =="txt") lang ="plaintext";
else lang ="javascript";
$(".code-file").style.display ="flex";
$(".code-file div span:nth-of-type(1)").innerHTML = x;
$(".code-file pre").innerHTML = `<code class="language-${lang}">${y}</code>`;

if(!navigator.clipboard){$(".code-file div span:nth-of-type(2) i:nth-of-type(2)").style.display ="none";}
else{$(".code-file div span:nth-of-type(2) i:nth-of-type(2)").style.display ="flex";}
}
function reHighlight(element){
 element.removeAttribute("data-highlighted");
 element.classList.remove("hljs"); 
 hljs.highlightElement(element);
}
function hideCodeFile(){
let element = $(".code-file");
 element.removeAttribute("data-highlighted");
 element.classList.remove("hljs"); 
 $(".code-file").style.display ="none";
}

// Copy code
$(".code-file div span:nth-of-type(2) i:nth-of-type(2)").onclick = function(){
let text = this.closest(".code-file").querySelector("pre").innerText;
const copyText = t => navigator.clipboard?.writeText(t) ||
(document.body.appendChild(Object.assign(document.createElement("textarea"), {value: t})).select(),
   document.execCommand("copy"),
   document.body.lastChild.remove());
copyText(text);
}

// Download code
$(".code-file div span:nth-of-type(2) i:nth-of-type(1)").onclick = function(){
let name = this.closest(".code-file").querySelector("div span:nth-of-type(1)").innerText;
let content = this.closest(".code-file").querySelector("pre").innerText;
const a = document.createElement("a");
a.href = URL.createObjectURL(new Blob([content], {type: "text/plain"}));
a.download = name;
a.click();
URL.revokeObjectURL(a.href);
}


/* Keys */
//DOWNLOAD
function download(){
 const link = document.createElement('a');
 link.href = "Namaste-NodeJS.zip";
 link.download = "Namaste-NodeJS.zip";
 document.body.appendChild(link);
 link.click();
 document.body.removeChild(link);
}


//SHARE
if(navigator.share){
 function share(){
 navigator.share({
  title: "Namaste NodeJS",
  text: "Check out these Namaste NodeJS notes",
  url: "https://namastenodejs.netlify.app",
  })
  .then(() => console.log('Successfully shared'))
  .catch((error) => console.error('Error sharing:', error));
  }}
else{
 $(".keys button")[1].style.display ="none";
}

//Report
function report(){
 window.location.href = "https://telegram.me/ashutosh_dev?text=Hey! I was checking out your Namaste NodeJS website and came across a bug. Here's what I found:";
}
</script>
</body>
</html>
